# Anchor Demo App

## 목적

재생 컨트롤과 스크롤이 연동되는 UX 패턴을 시연하기 위한 Flutter 데모입니다.  
녹음 중 체크한 타임스탬프를 기준으로 장문 전사 페이지의 재생 컨트롤러에 마크를 생성하고, 해당 마크를 누르면 편집해야할 텍스트로 빠르게 이동하기 위하여 일반적으로 사용하는 앵커링크 코드를 사용하려 했습니다.
그런데 이 과정에서 다양한 오류와 충돌이 있었습니다. 현재 프로젝트는 음성파일과 텍스트의 위치를 연동하고, 재생하며, 체크 타임을 기준으로 매칭되는 텍스트에 하이라이트를 적용하는 등 일반적으로 앵커 링크를 사용하는 환경보다 복잡한 상황입니다.
이에 이러한 특성을 역이용하여 재생컨트롤러와 전사 텍스트의 리스트뷰 스크롤을 연동하는 방식을 생각했습니다.
이에따라 실시간세션에서 마킹한 곳으로 이동할 수 있을 뿐 아니라 그외 구간도 컨트롤러의 조작으로 스크롤을 제어할 수 있게된 점에서 더 유연한 사용성을 갖게되어 만족스러운 선택이었습니다.

## 주요 기능

- **재생 시뮬레이터**: `PlaybackSimulator`가 실제 오디오 없이도 재생/일시정지/탐색 이벤트를 모사합니다.
- **타임라인 컨트롤러**: `TimelineDemoControls` 위젯이 재생 막대, 마커, 탐색 버튼 등을 제공해 위치 이동을 시각적으로 표현합니다.
- **세그먼트 스크롤 연동**: `SegmentScrollCoordinator`가 재생 위치에 맞춰 텍스트 세그먼트를 스크롤하고, 세그먼트를 탭하면 재생 위치가 이동합니다.
- **데모 데이터**: `buildDemoData()`가 단순한 대화 스크립트와 체크포인트를 생성하여 UX 흐름을 빠르게 테스트할 수 있게 해줍니다.

## 화면 흐름

1. 앱이 시작되면 `AnchorDemoPage`가 데모 데이터를 로드하고, 재생 시뮬레이터 및 스크롤 코디네이터를 초기화합니다.
2. 상단 `CustomScrollView`는 세그먼트 리스트를 렌더링하며, 현재 재생 위치에 해당하는 카드에 강조 배경을 적용합니다.
3. 하단 `TimelineDemoControls`에서 슬라이더를 드래그하거나 마커를 탭하면 재생 위치가 이동하고, 리스트는 해당 세그먼트를 중심으로 스크롤됩니다.
4. 반대로 세그먼트 카드를 탭하면 해당 타임스탬프로 이동하면서 타임라인 UI가 자동으로 갱신됩니다.


## 폴더 구조 요약

- `lib/main.dart` – 전체 데모 페이지 구성 및 상태 관리.
- `lib/data.dart` – 데모 세그먼트/체크 데이터와 지속 시간 계산.
- `lib/playback.dart` – 재생 시뮬레이터와 관련 스트림 제공.
- `lib/scrolling.dart` – 세그먼트 앵커 계산 및 스크롤 동기화 로직.
- `lib/widgets/` – 타임라인, 세그먼트 리스트 등 UI 컴포넌트 모음.
- `lib/constants.dart` – 스크롤 앵커 오프셋, 일시정지 시 스크롤 임계값 등 상수 정의.

## 커스터마이징 포인트

- **데이터 교체**: `buildDemoData()`를 수정해 실제 서비스 데이터나 더 많은 세그먼트를 시뮬레이션할 수 있습니다.
- **스크롤 기준 조정**: `constants.dart`의 `scrollAnchorOffset`으로 타임라인과 리스트 맞춤 위치를 변경할 수 있습니다.
- **재생 로직 확장**: 현재는 시뮬레이션이지만, `PlaybackSimulator`를 실제 플레이어 인터페이스로 교체하면 실서비스와 동일한 경험을 테스트할 수 있습니다.

## 개선방향

데모에서는 제대로 테스트해 보지 않았으나, 실제 프로젝트에서는 컨트롤러 조정에 따른 스크롤의 이동이 부자연스러운 구간이 많이 거슬림. 
발화 세그먼트가 전환 될 떄 이런 현상이 있는 것을 보아서 데이터를 발화 세그먼트 단위로 처리하는 어떤 로직이 있을거라 추측됨. 
우선 데모에서 발화 세그먼트의 두께를 늘려서 실제프로젝트 처럼 튀는 구간이 있는지 다시 파악하고 데모에서는 발생하지 않는다면 실제 프로젝트와 데모의 구조 차이를 비교하여 실제 프로젝트 파일의 코드를 수정해 본다.


## 개발 메모

- Flutter 3.2 이상 버전을 요구합니다.
- 데모 특성상 외부 의존성은 없습니다.

이 데모를 기반으로 재생 UX 연구, 디자인 검증, 또는 내부 도구 프로토타입 제작을 빠르게 진행할 수 있습니다.
